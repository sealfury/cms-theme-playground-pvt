<!--
    templateType: blog_post
    isAvailableForNewContent: true
    label: Customer Stories Post
-->
{% set template_css = "../../css/templates/blog.css" %}
{% extends "./layouts/base.html" %}

{% block body %}
  <div class="body-container body-container--blog-post">
    {% module "hero-banner"
      path="../modules/hero-banner.module",
      header="<strong>{{ content.name }}:</strong> Edit module to edit text",
      subheader="Edit module to edit text field",
      buttons=null,
      column="logo" %}

    {# Blog post #}
    <div class="content-wrapper">
      <div class="customer-stories__container">
        <article class="blog-post">
          <div>
            <a href="{{ blog_author_url(group.id, content.blog_post_author.slug) }}" rel="author">
              {{ content.blog_post_author.display_name }}
            </a>
            <time>
              {{ content.publish_date_localized }}
            </time>
          </div>
          <div>
            {{ content.post_body }}
          </div>
          {% if content.tag_list %}
            <div>
              {% for tag in content.tag_list %}
              <a href="{{ blog_tag_url(group.id, tag.slug) }}" rel="tag">{{ tag.name }}</a>
              {% if not loop.last %},{% endif %}
              {% endfor %}
            </div>
          {% endif %}
        </article>
        {% module "logo-section"
          path="../modules/logo.module",
          light_mode="false",
          extra_classes="logo-section" %}
      </div>
    </div>

    {# End blog post #}

    {% macro related_posts(post, count, total) %}
      {% if count == 1 %}
        <section class="blog-related-posts">
          <div class="content-wrapper">
            {% if content.language.language == "en" %}
              {% set parentBlog = blog_by_id(group.id) %}
              {% set sectionHeader = "More {{ parentBlog.htmlTitle }}" %}
            {% endif %}
            <h2>{{ sectionHeader }}</h2>
            <div class="blog-related-posts__list">
            {% endif %}
            <article
              class="blog-related-posts__post"
              aria-label="Blog post summary: {{ post.name }}"
            >
              {% if post.featured_image %}
                <a
                  class="blog-related-posts__post-image-wrapper"
                  href="{{ post.absolute_url }}"
                  aria-label="{% if post.featured_image_alt_text %} Featured image: {{ post.featured_image_alt_text }} - {% endif %}Read full post: {{ post.name }}"
                >
                  <img
                    class="blog-related-posts__image"
                    src="{{ post.featured_image }}"
                    loading="lazy"
                    width="352"
                    alt="{{ post.featured_image_alt_text }}"
                  />
                </a>
              {% endif %}
              <div class="blog-related-posts__content">
                <h3 class="blog-related-posts__title">
                  <a class="blog-related-posts__title-link" href="{{ post.absolute_url }}"
                    >{{ post.name }}</a
                  >
                </h3>
                {{ post.post_summary|truncatehtml(100) }}
              </div>
            </article>
            {% if count == total %}
            </div>
          </div>
        </section>
      {% endif %}
    {% endmacro %}

    {% related_blog_posts
      limit=3,
      no_wrapper=True,
      post_formatter="related_posts" %}

    {% module "newsletter"
      path="../modules/newsletter-cta.module" %}

    <div class="blog-post__cta">
      <div class="blog-post__cta--single">
        {% module "cta-light"
          path="../modules/cta-small",
          mode="light" %}
      </div>
      <div class="blog-post__cta--single">
        {% module "cta-dark"
          path="../modules/cta-small",
          mode="dark" %}
      </div>
    </div>
  </div>
{% endblock body %}
